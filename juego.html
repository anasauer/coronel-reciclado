<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Juego de Reciclado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        

        body {
            font-family: 'Raleway', sans-serif;
            background-image: url('img/ruinas.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #f9fafb;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
            width: 100vw; 
            height: 100vh;
            overflow-x: hidden;
        }
        .game-wrapper {
            background-color: rgba(17, 24, 39, 0.7);
            padding: 2rem;
            border-radius: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 600px;
        }
        #gameCanvas {
            border-radius: 1rem;
            background-color: rgba(20, 25, 20, 0.8);
            border: 2px solid #4b5563;
            cursor: pointer;
            touch-action: none;
            width: 100%;
            height: auto;
            max-width: 450px;
            transition: all 0.3s ease;
        }
        .game-info {
            margin: 1rem 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 1rem 2rem;
            font-weight: bold;
        }
        .flash-red {
            animation: incorrectPlacement 0.5s forwards;
        }
        @keyframes incorrectPlacement {
            0% { background-color: #ef4444; }
            100% { background-color: rgba(20, 25, 20, 0.8); }
        }
        .message-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 1rem;
            padding: 2rem;
            border: 2px solid #3b82f6;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 100;
        }
        .btn {
            background-color: #4b5563;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition-property: background-color, transform;
            transition-duration: 300ms;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn:hover {
            background-color: #6b7280;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="game-wrapper">
        <h1 class="text-3xl font-bold mb-4">鮫勇 Juego de Reciclado</h1>
        <p class="mb-4">Arrastra y suelta los objetos en el contenedor correcto.</p>
        <div class="game-info">
            <div id="gameScore">Puntos: 0</div>
            <div id="gameLives">Vidas: 仇벒잺仇벒잺仇벒잺仇벒잺仇벒잺</div>
            <div id="gameTimer">Tiempo: 60</div>
            <button id="backGameButton" class="btn bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-slate-900">
                <i class="fas fa-arrow-left"></i>
                <span>Regresar</span>
            </button>
            <button id="restartGameButton" class="btn bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-slate-900">
                <i class="fas fa-arrows-rotate"></i>
                <span>Reiniciar</span>
            </button>
            <button id="toggleButton" class="btn bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-slate-900">
                <i id="toggleIcon" class="fas fa-pause"></i>
                <span id="toggleText">Pausar</span>
            </button>
        </div>
        <div class="relative w-full max-w-lg aspect-square">
            <canvas id="gameCanvas"></canvas>
            <div id="messageBox" class="message-box flex flex-col items-center justify-center text-center">
                <h2 id="messageTitle" class="text-xl font-bold text-gray-100 mb-2"></h2>
                <p id="messageText" class="text-gray-300 mb-4"></p>
                <button id="restartButton" class="btn btn-green">
                    Jugar de Nuevo
                </button>
                <button id="returnButton" class="btn bg-gray-600 hover:bg-gray-700 mt-4">
                    Regresar a la p치gina principal
                </button>
            </div>
        </div>
    </div>
<script>
    class RecyclingGame {
        constructor(canvas, scoreEl, livesEl, timerEl, messageBoxEl, messageTitleEl, messageTextEl, restartButtonEl, toggleButtonEl, toggleIconEl, toggleTextEl, returnButtonEl, backGameButtonEl) {
            this.canvas = canvas;
            this.ctx = canvas.getContext('2d');
            this.scoreEl = scoreEl;
            this.livesEl = livesEl;
            this.timerEl = timerEl;
            this.messageBoxEl = messageBoxEl;
            this.messageTitleEl = messageTitleEl;
            this.messageTextEl = messageTextEl;
            this.restartButtonEl = restartButtonEl;
            this.toggleButtonEl = toggleButtonEl;
            this.toggleIconEl = toggleIconEl;
            this.toggleTextEl = toggleTextEl;
            this.returnButtonEl = returnButtonEl;
            this.backGameButtonEl = backGameButtonEl;

            this.items = [];
            this.bins = [];
            this.score = parseInt(localStorage.getItem('currentScore')) || 0;
            this.lives = 5;
            this.timer = 60;
            this.gameOver = false;
            this.isDragging = false;
            this.draggedItem = null;
            this.frameId = null;
            this.spawnTimer = 0;
            this.lastTime = 0;
            this.paused = false;

            // ** L칍GICA DE ADAPTACI칍N: Tipos de 칤tems y tachos **
            this.allItemTypes = [
                { type: 'Vidrio', icon: '游', binSrc: 'img/vidrio.png', name: 'Vidrio' },
                { type: 'Papel', icon: '游늯', binSrc: 'img/papel.png', name: 'Papel' },
                { type: 'Pl치stico', icon: '游빖', binSrc: 'img/plastico.png', name: 'Pl치stico' },
                { type: 'Org치nico', icon: '游꼝', binSrc: 'img/organico.png', name: 'Org치nico' },
                { type: 'Metal', icon: '游볾', binSrc: 'img/metal.png', name: 'Metal' }
            ];

            // Filtramos los tipos de 칤tems que usaremos.
            this.isMobile = this.canvas.width < 600;

            if (this.isMobile) {
                this.itemTypes =
